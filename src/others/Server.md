# 服务器

## Nginx

Nginx是一个轻量级/高性能的反向代理Web服务器，实现非常高效的反向代理与负载平衡，可以处理2-3万并发连接数，官方检测能支持5万并发。

特点：

- 跨平台，配置简单，响应快
- 反向代理
- 耗费内存少
- 处理静态文件好
- 高并发连接：可以处理2-3万并发连接数，官方检测能支持5万并发
- 健康检查：若一个服务器宕机，会做一个健康检查，再发送的请求就不会发送到宕机的服务器了，重新提交到其他节点上
- 节省宽带：支持gzip压缩，可以添加浏览器本地缓存
- 稳定性高：宕机概率非常小
- 接收用户请求是异步的

缺点：动态处理差（指处理动态页面）

应用场景：

- HTTP服务器
- 虚拟主机
- 反向代理，负载均衡
- 安全管理

### 反向代理

***TODO***

### 配置文件

***TODO***

### 动静分离

让动态网站里的动态网页根据一定规则把不变的资源和经常变的资源区分开，动静分离后可以根据静态资源的特点将其做缓存操作。

动静分离的原因：

- 网站优化重点在于静态化网站，静态化网站的关键点则为动静分离；
- Nginx静态处理能力强，但动态处理能力不足；
- 静态资源如图片、JS、CSS等文件在Nginx中缓存，浏览器在请求一个静态资源时，Nginx就可以直接处理，无需将请求转发给后端服务器；若用户请求的动态文件则转发给后端服务器处理；
- 让静态资源只走静态资源服务器，动态的走动态资源服务器。

### 负载均衡

为避免服务器崩溃，会通过负载均衡的方式来分担服务器压力，将多台服务器组成一个集群，当用户访问时，先访问至一个转发服务器，再由转发服务器将访问分发到压力更小的服务器。

负载均衡实现策略：

- 轮询（默认）
  - 每个请求按时间顺序逐一分配至不同的后端服务器，若后端某个服务器宕机，自动剔除故障系统；
- 权重（weight）
  - 权值越大分配到的访问频率越高，主要用于后端每台服务器性能不均衡的情况下；
  - 为在主从的情况下设置不同的权值，达到合理有效地利用主机资源；
- IP绑定（ip\_hash）
  - 每个请求按访问IP的哈希结果分配，使来自同一IP的访客固定访问一台后端服务器，且可以有效地解决动态网页存在的session共享问题；
- fair（第三方插件）
- url\_hash（第三方插件）

### 限流

限制用户请求速度，防止服务器宕机。限流有以下几种：

- 正常限制访问频率（正常流量）
- 突发限制访问频率（突发流量）
- 限制并发连接数

#### 限流算法

- 漏桶流算法
- 令牌桶算法

### 虚拟主机

- 基于域名的虚拟主机，通过域名来区分虚拟主机（如外部网站）
- 基于端口的虚拟主机，通过端口来区分虚拟主机（如公司内部网站、外部网站的管理后台）
- 基于IP的虚拟主机

***TODO***

## Tomcat

***TODO***