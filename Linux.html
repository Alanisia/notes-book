<!DOCTYPE HTML>
<html lang="zh-CN" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Linux - Notes</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">README</li><li class="chapter-item expanded "><a href="basis.html"><strong aria-hidden="true">1.</strong> 基础</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="basis/DataStructuresAndAlgorithms.html"><strong aria-hidden="true">1.1.</strong> 数据结构与算法</a></li><li class="chapter-item expanded "><a href="basis/OS.html"><strong aria-hidden="true">1.2.</strong> 操作系统</a></li><li class="chapter-item expanded "><a href="basis/Network.html"><strong aria-hidden="true">1.3.</strong> 计算机网络</a></li><li class="chapter-item expanded "><a href="basis/Project.html"><strong aria-hidden="true">1.4.</strong> 项目管理</a></li></ol></li><li class="chapter-item expanded "><a href="java.html"><strong aria-hidden="true">2.</strong> Java</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="java/JavaSE.html"><strong aria-hidden="true">2.1.</strong> 基础</a></li><li class="chapter-item expanded "><a href="java/Collections.html"><strong aria-hidden="true">2.2.</strong> 集合</a></li><li class="chapter-item expanded "><a href="java/Concurrent.html"><strong aria-hidden="true">2.3.</strong> 并发</a></li><li class="chapter-item expanded "><a href="java/JVM.html"><strong aria-hidden="true">2.4.</strong> 虚拟机</a></li><li class="chapter-item expanded "><a href="java/IO.html"><strong aria-hidden="true">2.5.</strong> 输入输出</a></li><li class="chapter-item expanded "><a href="java/Frameworks.html"><strong aria-hidden="true">2.6.</strong> 框架</a></li><li class="chapter-item expanded "><a href="java/DesignPatterns.html"><strong aria-hidden="true">2.7.</strong> 设计模式</a></li><li class="chapter-item expanded "><a href="java/BigData.html"><strong aria-hidden="true">2.8.</strong> 大数据</a></li></ol></li><li class="chapter-item expanded "><a href="database/Database.html"><strong aria-hidden="true">3.</strong> 数据库</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="database/SQL.html"><strong aria-hidden="true">3.1.</strong> SQL</a></li><li class="chapter-item expanded "><a href="database/MySQL.html"><strong aria-hidden="true">3.2.</strong> MySQL</a></li></ol></li><li class="chapter-item expanded "><a href="Linux.html" class="active"><strong aria-hidden="true">4.</strong> Linux</a></li><li class="chapter-item expanded "><a href="go.html"><strong aria-hidden="true">5.</strong> Go</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="go/Go.html"><strong aria-hidden="true">5.1.</strong> 基础</a></li><li class="chapter-item expanded "><a href="go/Goroutine.html"><strong aria-hidden="true">5.2.</strong> 协程</a></li></ol></li><li class="chapter-item expanded "><a href="frontend.html"><strong aria-hidden="true">6.</strong> 前端</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="frontend/HTML&CSS.html"><strong aria-hidden="true">6.1.</strong> HTML &amp; CSS</a></li><li class="chapter-item expanded "><a href="frontend/Browser.html"><strong aria-hidden="true">6.2.</strong> 浏览器</a></li></ol></li><li class="chapter-item expanded "><a href="android.html"><strong aria-hidden="true">7.</strong> 安卓</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="android/Activity.html"><strong aria-hidden="true">7.1.</strong> 活动</a></li><li class="chapter-item expanded "><a href="android/System.html"><strong aria-hidden="true">7.2.</strong> 系统</a></li></ol></li><li class="chapter-item expanded "><a href="others.html"><strong aria-hidden="true">8.</strong> 其他</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="others/Distributed.html"><strong aria-hidden="true">8.1.</strong> 分布式</a></li><li class="chapter-item expanded "><a href="others/Server.html"><strong aria-hidden="true">8.2.</strong> 服务器</a></li><li class="chapter-item expanded "><a href="others/Middleware.html"><strong aria-hidden="true">8.3.</strong> 中间件</a></li><li class="chapter-item expanded "><a href="others/Docker.html"><strong aria-hidden="true">8.4.</strong> Docker</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Notes</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="linux"><a class="header" href="#linux">Linux</a></h1>
<h2 id="内核空间用户空间"><a class="header" href="#内核空间用户空间">内核空间&amp;用户空间</a></h2>
<p>在一个32位系统中，一个程序的虚拟空间最大可以是4GB，最直接的做法就是将内核也看作是一个程序，使它和其他程序一样也具有4GB空间，但这种做法会使系统不断地切换用户程序的页表和内核页表，以致影响计算机的效率。解决此问题之最好做法是把4GB空间分成两部分：一之用户空间，一之内核空间，这样则可保证内核空间固定不变，而当程序切换时改变的仅是程序之页表，其唯一缺点在于内核空间与用户空间均变小了。</p>
<p>Linux以<code>PAGE_OFFSET</code>为界将4GB的虚拟内存空间分为两部分：地址<code>0 to 3GB-1</code>这段低地址空间为用户空间，大小3GB；地址<code>3GB to 4GB-1</code>这段高地址空间为内核空间，大小1GB。</p>
<h2 id="常用命令"><a class="header" href="#常用命令">常用命令</a></h2>
<ul>
<li>网络
<ul>
<li>
<p>查询域名对应IP地址</p>
<ul>
<li>
<p>nslookup：检测网络中DNS服务器能否正确解析域名，用于查询互联网域名服务器</p>
<pre><code class="language-bash">nslookup &lt;domain&gt;
</code></pre>
</li>
<li>
<p>dig：用于查询DNS名称</p>
</li>
<li>
<p>host：用于执行DNS查询</p>
</li>
<li>
<p>ping：用于向网络主机发送ICMP请求应答数据包，检测某服务器到其他服务器的网络连接情况</p>
</li>
<li>
<p>fping：用于向网络主机发送ICMP请求应答数据包</p>
</li>
</ul>
</li>
<li>
<p>ifconfig、ip：显示网卡挂载的信息</p>
<pre><code class="language-bash">ifconfig -a
</code></pre>
</li>
<li>
<p>telnet：检测某服务器的端口是否可以正常对外服务</p>
<pre><code class="language-bash">telnet &lt;ip&gt; &lt;port&gt;
</code></pre>
</li>
<li>
<p>nc：模拟开启TCP/IP的服务器，通常用于拦截HTTP传递的参数，帮助定位RESTful服务的问题</p>
</li>
<li>
<p>mtr：检测网络连通性问题，并可以获取某一个域名或者IP的丢包率</p>
<pre><code class="language-bash">mtr -r &lt;domain&gt;
</code></pre>
</li>
<li>
<p>traceroute：跟踪网络传输的详细路径，显示每一级网关的信息</p>
<pre><code class="language-bash">traceroute &lt;domain&gt;
</code></pre>
</li>
<li>
<p>sar：为全面监控网络、磁盘、CPU、内存等信息的轻量级工具</p>
</li>
<li>
<p>netstat、ss：用于查看网络端口的连接情况</p>
<pre><code class="language-bash">netstat -nap
</code></pre>
</li>
<li>
<p>tcpdump：可以拦截本机网卡上任何协议的通信内容，用于调试网络问题</p>
</li>
<li>
<p>iptraf：用于获取网络I/O的传输速度及其他网络状态信息</p>
</li>
<li>
<p>nmap：扫描某一服务器打开的端口</p>
<pre><code class="language-bash">nmap -v -A localhost
</code></pre>
</li>
<li>
<p>ethtool：查看网卡的配置或配置网卡</p>
</li>
<li>
<p>curl：模拟HTTP调用，常用于RESTful服务的简单测试</p>
<pre><code class="language-bash">curl -i &lt;URL&gt; # 打印请求响应头信息
curl -v &lt;URL&gt; # 打印更多的调试信息
curl -d 'abc=def' &lt;URL&gt; # 使用POST方法提交HTTP请求
curl -I &lt;URL&gt; # 仅返回HTTP头
curl -sw '%{http_code}' &lt;URL&gt; # 打印HTTP响应码
</code></pre>
</li>
</ul>
</li>
<li>进程 
<ul>
<li>
<p>ps：显示系统内的进程</p>
</li>
<li>
<p>top、htop：用于查看活动进程内的CPU和内存信息，能够实时显示系统中各个进程的资源占用情况，可以按照CPU、内存的使用情况和执行时间对进程进行排序</p>
</li>
<li>
<p>pidstat：针对某一进程输出系统资源的使用情况，包括CPU、内存、I/O等</p>
<pre><code class="language-bash">pidstat -[u|r|d] -p &lt;PID&gt; # u=cpu, r=内存, d=磁盘I/O
</code></pre>
</li>
<li>
<p>pstack：打印进程内的调用堆栈</p>
<pre><code class="language-bash">pstack &lt;PID&gt;
</code></pre>
</li>
<li>
<p>strace：跟踪进程内的工作机制</p>
<pre><code class="language-bash"># 跟踪进程ID为PID的进程上与信号有关的系统调用
strace -e trace=signal -p PID
</code></pre>
</li>
<li>
<p>lsof：查看某个进程打开的文件句柄</p>
<pre><code class="language-bash">lsof -p &lt;PID&gt; # 查看某个进程打开的文件句柄
lsof -i:&lt;PORT&gt; # 查看某个端口的使用方式
</code></pre>
</li>
<li>
<p>ulimit：查看用户对资源使用的限制，如打开的最大文件句柄、创建的最大线程数等</p>
<pre><code class="language-bash">ulimit -a
</code></pre>
</li>
</ul>
</li>
<li>内存
<ul>
<li>
<p>free：查看系统的内存使用情况</p>
</li>
<li>
<p>pmap：查看进程的详细的内存分配情况</p>
<pre><code class="language-bash">pmap -d &lt;PID&gt;
</code></pre>
</li>
</ul>
</li>
<li>CPU监控
<ul>
<li>
<p>vmstat：查看系统的CPU利用率、负载、内存等信息</p>
</li>
<li>
<p>mpstat：查看系统的CPU利用率、负载，并且按照CPU核心分别显示相关信息</p>
<pre><code class="language-bash">mpstat -P ALL
</code></pre>
</li>
</ul>
</li>
<li>磁盘I/O监控
<ul>
<li>
<p>iostat：查看磁盘I/O的信息及传输速度</p>
<pre><code class="language-bash">iostat -x
</code></pre>
</li>
<li>
<p>swapon：查看系统交换区的使用情况</p>
<pre><code class="language-bash">swapon -s
</code></pre>
</li>
<li>
<p>df：显示磁盘挂载的信息</p>
<pre><code class="language-bash">df -h
</code></pre>
</li>
</ul>
</li>
<li>摘要
<ul>
<li>md5sum：生成md5摘要</li>
<li>sha256：生成sha256摘要</li>
<li>base64：生成base64编码</li>
</ul>
</li>
<li>文本处理 
<ul>
<li>
<p>grep：文本内容（关键字）查找</p>
<pre><code class="language-bash"># --color: 查找后着色
grep -5 'pattern' INPUT_FILE # 打印匹配行的前后5行
grep -C 5 'pattern' INPUT_FILE # 打印匹配行的前后5行
grep -A 5 'pattern' INPUT_FILE # 打印匹配行的后5行
grep -B 5 'pattern' INPUT_FILE # 打印匹配行的前5行
</code></pre>
</li>
<li>
<p>find：通过文件名查找文件所在位置，支持模糊匹配</p>
<pre><code class="language-bash">find . -name FILE_NAME
</code></pre>
</li>
<li>
<p>sed：文本编辑与替换</p>
</li>
<li>
<p>tr：字符替换</p>
</li>
<li>
<p>cut：选取，分析一段数据并取出想要的部分</p>
</li>
<li>
<p>dos2unix、unix2dos：转换Windows和UNIX的换行符</p>
</li>
<li>
<p>awk：文本分析工具，支持脚本处理</p>
</li>
</ul>
</li>
<li>数据处理与统计
<ul>
<li>sort：排序</li>
<li>uniq：去重或分组统计，与sort配合使用</li>
<li>wc：统计字数和行数等</li>
</ul>
</li>
<li>文件传输
<ul>
<li>scp：实现从本地到远程或从远程到本地的双向传输</li>
</ul>
</li>
<li>文件解压缩
<ul>
<li>tar：创建或解压tar格式的包</li>
<li>zip、unzip：压缩成zip格式的压缩包或解压</li>
<li>rar、unrar：压缩成rar格式的压缩包或解压</li>
</ul>
</li>
<li>其他
<ul>
<li>uptime：查看操作系统启动的时间、登录的用户、系统的负载等</li>
</ul>
</li>
</ul>
<h2 id="服务"><a class="header" href="#服务">服务</a></h2>
<p><em><strong>TODO</strong></em></p>
<h2 id="用户"><a class="header" href="#用户">用户</a></h2>
<p><em><strong>TODO</strong></em></p>
<h2 id="内核"><a class="header" href="#内核">内核</a></h2>
<p><em><strong>TODO</strong></em></p>
<h2 id="shell"><a class="header" href="#shell">Shell</a></h2>
<h3 id="管道"><a class="header" href="#管道">管道</a></h3>
<p>管道使用<code>|</code>连接多个命令，<code>|</code>唤作管道符，管道（pipe）格式：</p>
<pre><code class="language-bash">command1 | command2 [| commandN...]
</code></pre>
<p><code>|</code>左边的命令向标准输出写入，右边的命令向标准输出读取，此二命令可形成管道。</p>
<p><em>注意：<code>command1</code>必须有正确输出而<code>command2</code>必须可以处理<code>command1</code>的输出结果，且<code>command2</code>只能处理<code>command1</code>的正确输出结果，不能处理其错误信息。</em></p>
<p>使用了管道的命令有如下特点：</p>
<ul>
<li>命令的语法紧凑且使用简单；</li>
<li>通过使用管道，将多个命令串联在一起完成复杂任务；</li>
<li>从管道输出的标准错误会混合到一起。</li>
</ul>
<h2 id="重定向"><a class="header" href="#重定向">重定向</a></h2>
<p>文件描述符：用于标识一个文件，值为0或正整数，每当打开一个文件，系统会返回文件描述符（用来代表这个文件）。</p>
<p>有3个特殊的文件描述符：</p>
<ul>
<li>0：标准输入（standard input, stdin）</li>
<li>1：标准输出（standard output, stdout）</li>
<li>2：标准错误（standard error, stderr）</li>
</ul>
<p>此三者对应的符号常量分别为：<code>STDIN_FILENO</code>、<code>STDOUT_FILENO</code>、<code>STDERR_FILENO</code>。系统启动时此三描述符将自动打开。</p>
<p>重定向符：</p>
<ul>
<li><code>&gt;</code>：输出重定向，将数据输出到文件，当文件不存在时自动建立文件，文件存在时会覆盖前一次的内容</li>
<li><code>&lt;</code>：输入重定向，从文件读取</li>
<li><code>&gt;&gt;</code>：输出重定向，表示追加到文件中，不覆盖，当前输出内容会追加到文件尾部</li>
<li><code>&lt;&lt;</code>：表示当前标准输入来自命令行的一对分隔号的中间内容</li>
</ul>
<h3 id="空设备"><a class="header" href="#空设备">空设备</a></h3>
<p>空设备<code>/dev/null</code>，一个特别的设备文件，丢弃一切写入的数据。将输入重定向到此设备时将会丢弃全部输入。</p>
<h2 id="信号"><a class="header" href="#信号">信号</a></h2>
<p>信号就是一个通知（事件通知），用来通知某个进程发生了某一件事。信号是异步发生的，又称“软件中断”。</p>
<p>信号的产生：</p>
<ul>
<li>某个进程发送给另一个进程或者发送给自己</li>
<li>由内核发送给某个进程
<ul>
<li>通过在键盘上输入一些命令动作</li>
<li>内存访问异常</li>
</ul>
</li>
</ul>
<p>内核收到信号后的流程如下：</p>
<ol>
<li>系统切换到内核态</li>
<li>为调用信号处理函数需切换到用户态</li>
<li>调用信号处理函数</li>
<li>切回内核态进行收尾</li>
<li>切回用户态从中断代码处继续执行</li>
</ol>
<h3 id="信号处理相关动作"><a class="header" href="#信号处理相关动作">信号处理相关动作</a></h3>
<ul>
<li>执行系统默认动作</li>
<li>忽略此信号</li>
<li>捕捉该信号</li>
</ul>
<p><em>注：信号SIGKILL与SIGSTOP是特权信号，不要试图捕捉此二信号，对此二信号的处理程序代码无效。</em></p>
<h3 id="kill命令"><a class="header" href="#kill命令">kill命令</a></h3>
<pre><code class="language-bash">kill -n PID # n=信号编号，PID=进程ID
</code></pre>
<p>常用信号列举如下：<em><strong>TODO</strong></em></p>
<table><thead><tr><th>信号编号</th><th>信号名称</th><th>信号含义</th><th>操作系统默认动作</th></tr></thead><tbody>
<tr><td>1</td><td>SIGNUP</td><td></td><td></td></tr>
<tr><td>2</td><td>SIGINT</td><td></td><td></td></tr>
<tr><td>3</td><td>SIGQUIT</td><td></td><td>终端退出</td></tr>
<tr><td>4</td><td></td><td></td><td></td></tr>
<tr><td>5</td><td></td><td></td><td></td></tr>
<tr><td>6</td><td></td><td></td><td></td></tr>
<tr><td>7</td><td></td><td></td><td></td></tr>
<tr><td>8</td><td></td><td></td><td></td></tr>
<tr><td>9</td><td>SIGKILL</td><td></td><td>终止</td></tr>
<tr><td>10</td><td></td><td></td><td></td></tr>
<tr><td>11</td><td></td><td></td><td></td></tr>
<tr><td>12</td><td></td><td></td><td></td></tr>
<tr><td>13</td><td></td><td></td><td></td></tr>
<tr><td>14</td><td></td><td></td><td></td></tr>
<tr><td>15</td><td></td><td></td><td></td></tr>
<tr><td>16</td><td></td><td></td><td></td></tr>
<tr><td>17</td><td></td><td></td><td></td></tr>
<tr><td>18</td><td>SIGCOUT</td><td></td><td></td></tr>
<tr><td>19</td><td>SIGSTOP</td><td></td><td></td></tr>
<tr><td>20</td><td>SIGTSTP</td><td></td><td></td></tr>
<tr><td>21</td><td></td><td></td><td></td></tr>
<tr><td>22</td><td></td><td></td><td></td></tr>
<tr><td>23</td><td></td><td></td><td></td></tr>
<tr><td>24</td><td></td><td></td><td></td></tr>
</tbody></table>
<h3 id="信号编程"><a class="header" href="#信号编程">信号编程</a></h3>
<p>信号相关的定义与函数包含在<code>signal.h</code>中，使用时需要引入头文件<code>signal.h</code>：</p>
<pre><code class="language-c">#include &lt;signal.h&gt;
// c++: #include &lt;csignal&gt;
</code></pre>
<p>相关函数：</p>
<pre><code class="language-c">typedef void (*sighandler_t)(int);
/**
 * @param signal 信号
 * @param handler 信号处理函数
 */
sighandler_t signal(int signum, sighandler_t handler);
</code></pre>
<p>收到信号后可以用<code>signal()</code>来忽略或捕捉。</p>
<h4 id="可重入函数"><a class="header" href="#可重入函数">可重入函数</a></h4>
<p>可重入函数又称异步信号安全的函数，指在信号处理函数中调用是安全的函数。</p>
<p>有些周知的函数是不可重入的，如<code>malloc()</code>、<code>printf()</code>等。在信号处理时，不可重入函数可能会在调用时修改全局变量的值导致不安全，所以尽量避免在信号处理函数中调用不可重入函数。</p>
<p>关于系统函数在信号处理函数中的调用：</p>
<ul>
<li>在信号处理函数中应该尽量使用简单的语句做简单的事情，尽量不要调用系统函数以引起麻烦；</li>
<li>如果必须在信号处理函数中调用系统函数，只调用可重入函数；</li>
<li>如果必须在信号处理函数中调用那些可能修改<code>errno</code>的可重入函数，应考虑事先备份<code>errno</code>的值，事后再从信号处理函数返回之前恢复<code>errno</code>的值。</li>
</ul>
<h4 id="信号集信号屏蔽字"><a class="header" href="#信号集信号屏蔽字">信号集（信号屏蔽字）</a></h4>
<p>信号集可以表示为：0000000000,0000000000,0000000000...</p>
<p>如果收到某个信号就把信号集上的对应位置1。信号集在Linux中表示为<code>sigset_t</code>：</p>
<pre><code class="language-c">typedef struct {
  unsigned long sig[2]; // 两个无符号32位
} sigset_t;
</code></pre>
<p>相关函数：</p>
<pre><code class="language-c">// 信号清零
int sigemptyset(sigset_t *set);
// 所有信号置1
int sigfillset(sigset_t *set);
// 将某个信号置1
int sigaddset(sigset_t *set, int signum);
// 将某个信号置0
int sigdelset(sigset_t *set, int signum);
// 设置进程所对应的信号集
// 调用此函数会将新信号集设置为本进程所采用的信号集，同时将这个进程使用的旧信号集保存起来
int sigprocmask(int how, const sigset_t *set, sigset_t *oldset);
// 检测信号集的特定信号是否被置位
int sigismember(const sigset_t *set, int signum);
</code></pre>
<h2 id="进程"><a class="header" href="#进程">进程</a></h2>
<p>关闭终端后如何让进程不退出：</p>
<ul>
<li>拦截SIGHUP信号：<em><strong>TODO</strong></em></li>
<li>setsid命令：启动一个进程，而且能够使启动的进程在一个新的session中</li>
<li>后台执行
<ul>
<li><code>&amp;</code>：<em><strong>TODO</strong></em></li>
<li>nohup：<em><strong>TODO</strong></em></li>
</ul>
</li>
</ul>
<h3 id="进程状态"><a class="header" href="#进程状态">进程状态</a></h3>
<p>以下为<code>ps</code>命令输出中的STAT列的各状态字母的含义列表：</p>
<table><thead><tr><th>状态</th><th>含义</th></tr></thead><tbody>
<tr><td>D</td><td>不可中断的休眠状态（通常是I/O的进程），可以处理信号，有延时</td></tr>
<tr><td>R</td><td>可执行状态、运行状态（在运行队列里的状态）</td></tr>
<tr><td>S</td><td>可中断的休眠状态之中（等待某事件完成），可以处理信号</td></tr>
<tr><td>T</td><td>停止或被追踪（被作业控制信号所停止）</td></tr>
<tr><td>Z</td><td>僵尸进程</td></tr>
<tr><td>X</td><td>死掉的进程</td></tr>
<tr><td>N</td><td>低优先级的进程</td></tr>
<tr><td>&lt;</td><td>高优先级的进程</td></tr>
<tr><td>L</td><td>有些页被锁进内存</td></tr>
<tr><td>+</td><td>位于前台的进程组</td></tr>
<tr><td>s</td><td>会话首进程，其下有子进程</td></tr>
<tr><td>t</td><td>追踪期间被调试器停止</td></tr>
</tbody></table>
<h3 id="进程组与会话"><a class="header" href="#进程组与会话">进程组与会话</a></h3>
<ul>
<li>进程组：一个或多个进程的集合；</li>
<li>会话：一个或多个进程组的集合。</li>
</ul>
<p>创建会话的进程唤作会话首进程。可以调用函数创建新会话。</p>
<h3 id="子进程"><a class="header" href="#子进程">子进程</a></h3>
<p><em><strong>TODO</strong></em></p>
<h4 id="fork函数"><a class="header" href="#fork函数">fork函数</a></h4>
<p>操作系统使用<code>fork()</code>创建子进程。</p>
<h3 id="孤儿进程"><a class="header" href="#孤儿进程">孤儿进程</a></h3>
<p><em><strong>TODO</strong></em></p>
<h3 id="僵尸进程"><a class="header" href="#僵尸进程">僵尸进程</a></h3>
<p><em><strong>TODO</strong></em></p>
<h3 id="守护进程"><a class="header" href="#守护进程">守护进程</a></h3>
<p>一种长期运行的进程，这种进程在后台运行，不与任何控制终端关联，其基本特点如下：</p>
<ul>
<li>生存期长</li>
<li>无控制终端</li>
<li>后台运行</li>
</ul>
<p>调用<code>ps -efj</code>，对结果分析如下：</p>
<ul>
<li>PPID为0的是内核进程，跟随系统启动而启动，生命周期也是贯穿整个系统，不与终端挂钩，属于超级用户特权进程；</li>
<li>CMD列的进程是内核守护进程，所有内核守护进程都由kthreadd(PPID=0)创建，这些进程的PPID都为2；</li>
<li>系统守护进程init负责启动个运行层次特定的系统服务，init也负责收养孤儿进程；</li>
<li>用户级守护进程，多数是进程组的组长进程及会话首进程，而且是这些进程组和会话中的唯一进程。</li>
</ul>
<p>守护进程共同点：</p>
<ul>
<li>大多数守护进程以超级用户特权运行</li>
<li>无控制终端（TTY列显示为<code>?</code>）</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="database/MySQL.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="go.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="database/MySQL.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="go.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
