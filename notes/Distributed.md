# 分布式

当计算机的程序和数据通过网络分布在多于一台计算机上时，计算就成为分布式的。

### 分布式锁

当多个进程不在同一系统中，用分布式锁控制多个进程对资源的访问。在传统单机部署下，可以使用Java并发处理相关的API进行互斥控制。但在分布式系统中，由于系统多进程、多线程且分布在不同机器上，原单机并发的控制锁策略失效。

为保证分布式锁可用，需要分布式锁满足以下条件：

1. 互斥：任一时刻只能有一个客户端获取到锁，不能有两个客户端同时获取到锁；
2. 安全：锁只能由持有该锁的客户端删除，不能被其他客户端删除；
3. 容错：当某些节点宕机时，客户端仍能获取到锁；
4. 死锁：获取锁的客户端因某些原因无法释放锁，其他客户端再无法获取到锁。

#### 分布式锁的实现

1. 数据库乐观锁

2. Redis

    - 加锁：基于Redis命令：`SET key value NX EX max-lock-time`
    - 解锁：使用Lua脚本

3. ZooKeeper

### 分布式事务

***TODO***

## 集群

***TODO***

## 微服务

***TODO***

## RPC

远程过程调用（Remote Procedure Call），通过网络从远程计算机上请求服务，而不需要了解底层网络技术的协议。RPC假定某些协议存在，如TCP/UDP等，为通信程序之间携带信息数据。

### RPC实现

采用客户端-服务端的模式，通过request-response消息模式实现

RPC双端通信过程：

1. 建立通信：客户端与服务端建立网络通信连接；
2. 服务寻址：***TODO***
3. 网络传输：***TODO***
4. 服务调用：服务端经过本地调用（代理方式）得到返回值
5. 结果返回：***TODO***

## Dubbo

***TODO***

## Spring Cloud

***TODO***

## 服务发现与注册

***TODO***

### 注册中心

#### ZooKeeper

***TODO***

#### Eureka